/*! Built with http://stenciljs.com */
import*as tslib_1 from"../polyfills/tslib.js";import{h}from"../pie-demo.core.js";function loadCloudPies(e,t,o){void 0===o&&(o="https://pits-dot-kds-production-216220.appspot.com/bundles/");var i=t.getElementsByTagName("head")[0],n=Object.keys(e),s=function(s){var l,a=n[s],r=e[a],c=r.replace(/(?<=[a-z])\@(?:.(?!\@))+/g,""),d=t.createElement("script"),h=(l=c,function(){var e=l.split("+"),t=a.split("+");e.forEach(function(e,o){var i=window.pie.default[e],n=t[o];console.log("defining elements"),customElements.get(n)||(customElements.define(n,i.Element),customElements.define(n+"-config",i.Configure))})});d.id=a,d.onload=h,d.src=o+r+"/editor.js",i.appendChild(d)};for(var l in n)s(l)}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var ViewState,classnames=createCommonjsModule(function(e){!function(){var t={}.hasOwnProperty;function o(){for(var e=[],i=0;i<arguments.length;i++){var n=arguments[i];if(n){var s=typeof n;if("string"===s||"number"===s)e.push(n);else if(Array.isArray(n)&&n.length){var l=o.apply(null,n);l&&e.push(l)}else if("object"===s)for(var a in n)t.call(n,a)&&n[a]&&e.push(a)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):window.classNames=o}()});!function(e){e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.ERROR=2]="ERROR"}(ViewState||(ViewState={}));var PieDemo=function(){function e(){this.load=!0,this.editor=!0,this.preview=!0,this.playerControls=!0,this.state=ViewState.LOADING,this.toggled=this.preview,this.env={mode:"gather"},this.session={},this.loadPies=function(e){loadCloudPies(e,document)}}return e.prototype.toggleEditor=function(){this.toggled=!this.toggled},e.prototype.watchPie=function(e){var t,o=this;console.log("pie-watch triggered"),this.package=e,this.pieName=e.substr(e.lastIndexOf("/")+1,e.length).split("@")[0],this.pieName.indexOf("-")<0&&(this.pieName="x-"+this.pieName),customElements.whenDefined(this.pieName).then(function(){return tslib_1.__awaiter(o,void 0,void 0,function(){var e;return tslib_1.__generator(this,function(t){return e=this.package.replace(/(?<=[a-z])\@(?:.(?!\@))+$/,""),this.pieController=window.pie.default[e].controller,this.updatePieModelFromController(this.model,this.session,this.env),this.state=ViewState.READY,[2]})})}),this.load&&loadCloudPies(((t={})[this.pieName]=this.package,t),document)},e.prototype.updateModel=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return window.pie&&(console.log("model property updated"),this.configModel=e),[2]})})},e.prototype.watchConfigModel=function(e){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this.configElement&&(this.configElement.model=e),this.updatePieModelFromController(e,this.session,this.env),[2]})})},e.prototype.updatePieModelFromController=function(e,t,o){return tslib_1.__awaiter(this,void 0,void 0,function(){var i;return tslib_1.__generator(this,function(n){switch(n.label){case 0:return this.pieController?(i=this,[4,this.pieController.model(e,t,o)]):[3,2];case 1:i.pieElementModel=n.sent(),this.pieElement&&(this.pieElement.model=this.pieElementModel),n.label=2;case 2:return[2]}})})},e.prototype.watchPieElementModel=function(e){this.pieElement&&(this.pieElement.model=e)},e.prototype.componentWillLoad=function(){console.log("component will load ... "),this.watchPie(this.pie),this.model&&this.updateModel(this.model)},e.prototype.componentWillUpdate=function(){console.log("component will update ... ")},e.prototype.wachConfigElement=function(e){var t=this;e&&e.addEventListener("model.updated",function(e){console.log("model.updated"),t.configModel=e.detail&&e.detail.update,t.updatePieModelFromController(t.configModel,t.session,t.env)})},e.prototype.setMode=function(e){this.env.mode=e,this.updatePieModelFromController(this.configModel,this.session,this.env)},e.prototype.customCheckBox=function(e){var t=this,o=e.label,i=e.value;return h("label",{class:"custom-checkbox",onClick:function(){return t.setMode(i)}},h("span",{class:classnames("circle-container",{full:e.checked})},h("i",{"data-value":i,class:"circle"})),h("span",null,o))},e.prototype.render=function(){var e=this;switch(this.state){case ViewState.LOADING:return h("div",{id:"loading"},"Loading...");case ViewState.ERROR:return h("div",{id:"error"},"Error...");case ViewState.READY:console.log("rendering");var t=this.pieName,o=this.pieName+"-config";return h("div",{class:"root"},h("span",{class:"control-bar"},h("div",{class:classnames("authoring-header",{collapsed:!this.toggled})},h("h4",null,"Authoring View"),h("i",{class:classnames("fa",{"fa-caret-left":this.toggled,"fa-caret-right":!this.toggled}),onClick:function(){return e.toggleEditor()}})),h("div",{class:"student-view-header"},h("h4",null,"Student View"))),h("div",{class:"config-holder"},h("div",{class:"authoring-holder",style:{display:this.toggled?"block":"none"}},h(o,{id:"configure",ref:function(t){return e.configElement=t},model:this.model,session:this.session})),h("div",{class:"student-view-holder"},h("div",{class:"mode-config"},h("h5",null,"Mode"),h("div",{class:"modes-holder"},this.customCheckBox({label:"Gather",checked:"gather"===this.env.mode,value:"gather"}),this.customCheckBox({label:"View",checked:"view"===this.env.mode,value:"view"}),this.customCheckBox({label:"Evaluate",checked:"evaluate"===this.env.mode,value:"evaluate"}))),h(t,{id:"render",ref:function(t){console.log("Setare"),e.pieElement=t},model:this.pieElementModel,session:this.session}))))}},Object.defineProperty(e,"is",{get:function(){return"pie-demo"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{configElement:{state:!0,watchCallbacks:["wachConfigElement"]},configModel:{state:!0,watchCallbacks:["watchConfigModel"]},editor:{type:Boolean,attr:"editor"},env:{state:!0},load:{type:Boolean,attr:"load"},loadPies:{type:"Any",attr:"load-pies"},model:{type:"Any",attr:"model",watchCallbacks:["updateModel"]},package:{state:!0},pie:{type:String,attr:"pie",watchCallbacks:["watchPie"]},pieController:{state:!0},pieElement:{state:!0},pieElementModel:{state:!0,watchCallbacks:["watchPieElementModel"]},pieName:{state:!0},playerControls:{type:Boolean,attr:"player-controls"},preview:{type:Boolean,attr:"preview"},session:{state:!0},state:{state:!0},toggled:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"\@import url(\"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\");.control-bar{color:grey;display:-ms-flexbox;display:flex;font-size:16px;font-weight:700;-ms-flex-pack:justify;justify-content:space-between;width:100%}.control-bar .authoring-header{border-bottom:1px solid #db563b;-ms-flex:1;flex:1;margin-right:30px;position:relative}.control-bar .authoring-header.collapsed{max-width:20px}.control-bar .authoring-header.collapsed h4{display:none}.control-bar .authoring-header i{position:absolute;top:0;right:0}.control-bar .student-view-header{border-bottom:1px solid #db563b;-ms-flex:1 0 0px;flex:1 0 0}.authoring-holder{-ms-flex:1 0 0px;flex:1 0 0;margin-right:30px}.root{border:green}.config-holder{display:-ms-flexbox;display:flex;padding-bottom:20px;padding-top:20px;width:100%}.toggle-button{background-color:#d3d3d3;border:none;cursor:pointer;outline:none}.config-holder .student-view-holder{display:-ms-flexbox;display:flex;-ms-flex:1 0 0px;flex:1 0 0;-ms-flex-direction:column;flex-direction:column}.config-holder .student-view-holder .mode-config{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:20px}.config-holder .student-view-holder .mode-config .modes-holder{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-pack:distribute;justify-content:space-around}.custom-checkbox{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center}.custom-checkbox .circle-container{border:3px solid rgba(0,0,0,.54);border-radius:50%;display:inline-block;margin-right:5px;height:12px;padding:3px;width:12px}.custom-checkbox .circle{background:transparent;border-radius:50%;display:block;height:100%;width:100%}.custom-checkbox .circle-container.full .circle{background:#f50057}.custom-checkbox .circle-container.full{border-color:#f50057}"},enumerable:!0,configurable:!0}),e}();export{PieDemo};