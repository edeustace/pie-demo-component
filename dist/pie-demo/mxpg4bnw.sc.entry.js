/*! Built with http://stenciljs.com */
const{h:e}=window.PieDemo;function t(e,t,o="https://pits-dot-kds-production-216220.appspot.com/bundles/"){const s=t.getElementsByTagName("head")[0],i=Object.keys(e);for(const l in i){const a=i[l],n=e[a],d=n.replace(/(?<=[a-z])\@(?:.(?!\@))+/g,""),r=t.createElement("script"),c=(e=>()=>{const t=e.split("+"),o=a.split("+");t.forEach((e,t)=>{const s=window.pie.default[e],i=o[t];console.log("defining elements"),customElements.get(i)||(customElements.define(i,s.Element),customElements.define(i+"-config",s.Configure))})})(d);r.id=a,r.onload=c,r.src=o+n+"/editor.js",s.appendChild(r)}}var o,s,i=(function(e){!function(){var t={}.hasOwnProperty;function o(){for(var e=[],s=0;s<arguments.length;s++){var i=arguments[s];if(i){var l=typeof i;if("string"===l||"number"===l)e.push(i);else if(Array.isArray(i)&&i.length){var a=o.apply(null,i);a&&e.push(a)}else if("object"===l)for(var n in i)t.call(i,n)&&i[n]&&e.push(n)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):window.classNames=o}()}(o={exports:{}}),o.exports);!function(e){e[e.LOADING=0]="LOADING",e[e.READY=1]="READY",e[e.ERROR=2]="ERROR"}(s||(s={}));class l{constructor(){this.load=!0,this.editor=!0,this.preview=!0,this.playerControls=!0,this.state=s.LOADING,this.toggled=this.preview,this.env={mode:"gather"},this.session={},this.loadPies=(e=>{t(e,document)})}toggleEditor(){this.toggled=!this.toggled}watchPie(e){console.log("pie-watch triggered"),this.package=e,this.pieName=e.substr(e.lastIndexOf("/")+1,e.length).split("@")[0],this.pieName.indexOf("-")<0&&(this.pieName=`x-${this.pieName}`),customElements.whenDefined(this.pieName).then(async()=>{const e=this.package.replace(/(?<=[a-z])\@(?:.(?!\@))+$/,"");this.pieController=window.pie.default[e].controller,this.updatePieModelFromController(this.model,this.session,this.env),this.state=s.READY}),this.load&&t({[this.pieName]:this.package},document)}async updateModel(e){window.pie&&(console.log("model property updated"),this.configModel=e)}async watchConfigModel(e){this.configElement&&(this.configElement.model=e),this.updatePieModelFromController(e,this.session,this.env)}async updatePieModelFromController(e,t,o){this.pieController&&(this.pieElementModel=await this.pieController.model(e,t,o),this.pieElement&&(this.pieElement.model=this.pieElementModel))}watchPieElementModel(e){this.pieElement&&(this.pieElement.model=e)}componentWillLoad(){console.log("component will load ... "),this.watchPie(this.pie),this.model&&this.updateModel(this.model)}componentWillUpdate(){console.log("component will update ... ")}wachConfigElement(e){e&&e.addEventListener("model.updated",e=>{console.log("model.updated"),this.configModel=e.detail&&e.detail.update,this.updatePieModelFromController(this.configModel,this.session,this.env)})}setMode(e){this.env.mode=e,this.updatePieModelFromController(this.configModel,this.session,this.env)}customCheckBox({label:t,checked:o,value:s}){return e("label",{class:"custom-checkbox",onClick:()=>this.setMode(s)},e("span",{class:i("circle-container",{full:o})},e("i",{"data-value":s,class:"circle"})),e("span",null,t))}render(){switch(this.state){case s.LOADING:return e("div",{id:"loading"},"Loading...");case s.ERROR:return e("div",{id:"error"},"Error...");case s.READY:console.log("rendering");const t=this.pieName,o=this.pieName+"-config";return e("div",{class:"root"},e("span",{class:"control-bar"},e("div",{class:i("authoring-header",{collapsed:!this.toggled})},e("h4",null,"Authoring View"),e("i",{class:i("fa",{"fa-caret-left":this.toggled,"fa-caret-right":!this.toggled}),onClick:()=>this.toggleEditor()})),e("div",{class:"student-view-header"},e("h4",null,"Student View"))),e("div",{class:"config-holder"},e("div",{class:"authoring-holder",style:{display:this.toggled?"block":"none"}},e(o,{id:"configure",ref:e=>this.configElement=e,model:this.model,session:this.session})),e("div",{class:"student-view-holder"},e("div",{class:"mode-config"},e("h5",null,"Mode"),e("div",{class:"modes-holder"},this.customCheckBox({label:"Gather",checked:"gather"===this.env.mode,value:"gather"}),this.customCheckBox({label:"View",checked:"view"===this.env.mode,value:"view"}),this.customCheckBox({label:"Evaluate",checked:"evaluate"===this.env.mode,value:"evaluate"}))),e(t,{id:"render",ref:e=>{console.log("Setare"),this.pieElement=e},model:this.pieElementModel,session:this.session}))))}}static get is(){return"pie-demo"}static get properties(){return{configElement:{state:!0,watchCallbacks:["wachConfigElement"]},configModel:{state:!0,watchCallbacks:["watchConfigModel"]},editor:{type:Boolean,attr:"editor"},env:{state:!0},load:{type:Boolean,attr:"load"},loadPies:{type:"Any",attr:"load-pies"},model:{type:"Any",attr:"model",watchCallbacks:["updateModel"]},package:{state:!0},pie:{type:String,attr:"pie",watchCallbacks:["watchPie"]},pieController:{state:!0},pieElement:{state:!0},pieElementModel:{state:!0,watchCallbacks:["watchPieElementModel"]},pieName:{state:!0},playerControls:{type:Boolean,attr:"player-controls"},preview:{type:Boolean,attr:"preview"},session:{state:!0},state:{state:!0},toggled:{state:!0}}}static get style(){return"\@import url(\"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\");.control-bar{color:grey;display:-ms-flexbox;display:flex;font-size:16px;font-weight:700;-ms-flex-pack:justify;justify-content:space-between;width:100%}.control-bar .authoring-header{border-bottom:1px solid #db563b;-ms-flex:1;flex:1;margin-right:30px;position:relative}.control-bar .authoring-header.collapsed{max-width:20px}.control-bar .authoring-header.collapsed h4{display:none}.control-bar .authoring-header i{position:absolute;top:0;right:0}.control-bar .student-view-header{border-bottom:1px solid #db563b;-ms-flex:1 0 0px;flex:1 0 0}.authoring-holder{-ms-flex:1 0 0px;flex:1 0 0;margin-right:30px}.root{border:green}.config-holder{display:-ms-flexbox;display:flex;padding-bottom:20px;padding-top:20px;width:100%}.toggle-button{background-color:#d3d3d3;border:none;cursor:pointer;outline:none}.config-holder .student-view-holder{display:-ms-flexbox;display:flex;-ms-flex:1 0 0px;flex:1 0 0;-ms-flex-direction:column;flex-direction:column}.config-holder .student-view-holder .mode-config{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:20px}.config-holder .student-view-holder .mode-config .modes-holder{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-pack:distribute;justify-content:space-around}.custom-checkbox{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center}.custom-checkbox .circle-container{border:3px solid rgba(0,0,0,.54);border-radius:50%;display:inline-block;margin-right:5px;height:12px;padding:3px;width:12px}.custom-checkbox .circle{background:transparent;border-radius:50%;display:block;height:100%;width:100%}.custom-checkbox .circle-container.full .circle{background:#f50057}.custom-checkbox .circle-container.full{border-color:#f50057}"}}export{l as PieDemo};